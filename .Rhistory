power_row_indx <- if(fdr == TRUE){13:16} else {5:8}
if(low_eff_plot == FALSE){
dat <- data.frame(filterEffectVec, t(FwerPowerFdrPower[power_row_indx, ]))
} else {
power_col_indx <- 1:6
dat <- data.frame(filterEffectVec[power_col_indx],
t(FwerPowerFdrPower[power_row_indx, power_col_indx]))
}
colnames(dat) <- c("effectSize", "PRO", "BH", "RDW", "IHW")
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = value, group = variable,
col = variable)) +
geom_line(aes(linetype = variable), size = 1.5) +
labs(x = "Mean filter effect (ey)", y = "Power",
title = paste0("null = ", null, "%")) +
theme(legend.position = "none")
return(plt)
}
nice_plots(filterEffectVec=ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e1,
fdr = TRUE, null=50, low_eff_plot = TRUE)
dat
nice_plots <- function(filterEffectVec, FwerPowerFdrPower, fdr = TRUE, null,
low_eff_plot = FALSE)
{
power_row_indx <- if(fdr == TRUE){13:16} else {5:8}
dat <- data.frame(filterEffectVec, t(FwerPowerFdrPower[power_row_indx, ]))
colnames(dat) <- c("effectSize", "PRO", "BH", "RDW", "IHW")
if(low_eff_plot == FALSE){
ylab = "Power"
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = value, group = variable,
col = variable))
} else {
ylab = log(Power)
dat <- dat[1:6]
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = log(value), group = variable,
col = variable))
}
plt = plt + geom_line(aes(linetype = variable), size = 1.5) +
labs(x = "Mean filter effect (ey)", y = ylab,
title = paste0("null = ", null, "%")) +
theme(legend.position = "none")
return(plt)
}
nice_plots(filterEffectVec=ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e1,
fdr = TRUE, null=50, low_eff_plot = TRUE)
nice_plots <- function(filterEffectVec, FwerPowerFdrPower, fdr = TRUE, null,
low_eff_plot = FALSE)
{
power_row_indx <- if(fdr == TRUE){13:16} else {5:8}
dat <- data.frame(filterEffectVec, t(FwerPowerFdrPower[power_row_indx, ]))
colnames(dat) <- c("effectSize", "PRO", "BH", "RDW", "IHW")
if(low_eff_plot == FALSE){
ylab = "Power"
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = value, group = variable,
col = variable))
} else {
ylab = "log(Power)"
dat <- dat[1:6]
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = log(value), group = variable,
col = variable))
}
plt = plt + geom_line(aes(linetype = variable), size = 1.5) +
labs(x = "Mean filter effect (ey)", y = ylab,
title = paste0("null = ", null, "%")) +
theme(legend.position = "none")
return(plt)
}
nice_plots(filterEffectVec=ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e1,
fdr = TRUE, null=50, low_eff_plot = TRUE)
nice_plots <- function(filterEffectVec, FwerPowerFdrPower, fdr = TRUE, null,
low_eff_plot = FALSE)
{
power_row_indx <- if(fdr == TRUE){13:16} else {5:8}
dat <- data.frame(filterEffectVec, t(FwerPowerFdrPower[power_row_indx, ]))
colnames(dat) <- c("effectSize", "PRO", "BH", "RDW", "IHW")
if(low_eff_plot == FALSE){
ylab = "Power"
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = value, group = variable,
col = variable))
} else {
ylab = "log(Power)"
dat <- dat[1:6,]
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = log(value), group = variable,
col = variable))
}
plt = plt + geom_line(aes(linetype = variable), size = 1.5) +
labs(x = "Mean filter effect (ey)", y = ylab,
title = paste0("null = ", null, "%")) +
theme(legend.position = "none")
return(plt)
}
nice_plots(filterEffectVec=ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e1,
fdr = TRUE, null=50, low_eff_plot = TRUE)
nice_plots <- function(filterEffectVec, FwerPowerFdrPower, fdr = TRUE, null,
low_eff_plot = FALSE)
{
power_row_indx <- if(fdr == TRUE){13:16} else {5:8}
dat <- data.frame(filterEffectVec, t(FwerPowerFdrPower[power_row_indx, ]))
colnames(dat) <- c("effectSize", "PRO", "BH", "RDW", "IHW")
if(low_eff_plot == FALSE){
ylab = "Power"
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = value, group = variable,
col = variable))
} else {
ylab = "log(power)"
dat <- dat[1:6,]
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = log(value), group = variable,
col = variable))
}
plt = plt + geom_line(aes(linetype = variable), size = 1.5) +
labs(x = "Mean filter effect (ey)", y = ylab,
title = paste0("null = ", null, "%")) +
theme(legend.position = "none")
return(plt)
}
nice_plots(filterEffectVec=ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e1,
fdr = TRUE, null=50, low_eff_plot = TRUE)
nice_plots(filterEffectVec=ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e1,
fdr = TRUE, null=50, low_eff_plot = FALSE)
p_.5 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e1,
fdr = TRUE, null = 50, low_eff_plot = FALSE)
p_.9 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower4e1,
fdr = TRUE, null = 50, low_eff_plot = FALSE)
p_.99 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower5e1,
fdr = TRUE, null = 50, low_eff_plot = FALSE)
p_.5_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e1,
fdr = TRUE, null = 50, low_eff_plot = TRUE)
p_.9_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower4e1,
fdr = TRUE, null = 50, low_eff_plot = TRUE)
p_.99_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower5e1,
fdr = TRUE, null = 50, low_eff_plot = TRUE)
p_99_par <- ggplot(dat_99_par, aes(x = effectSize, y = value,group = variable,
col=variable)) +
geom_line(aes(linetype = variable), size = 1.5) +
labs(x = "ey", y = "power", title = "null = 99%") +
theme(legend.title = element_blank())
legend_power <- get_legend(p_99_par + theme(legend.direction="horizontal",
legend.position="bottom"))
dat_99 <- data.frame(filterEffectVec, t(FwerPowerFdrPower5e1[13:16,]))
colnames(dat_99) <- c("effectSize", "PRO", "BH", "RDW", "IHW")
dat_99_all <- melt(dat_99, id.var = "effectSize")
p_99_all <- ggplot(dat_99_all, aes(x = effectSize, y = value,group = variable,
col=variable)) +
geom_line(aes(linetype = variable), size = 1.5) +
labs(x = "ey", y = "power", title = "null = 99%") +
theme(legend.position="none")
p_99_par <- ggplot(dat_99_par, aes(x = effectSize, y = value,group = variable,
col=variable)) +
geom_line(aes(linetype = variable), size = 1.5) +
labs(x = "ey", y = "power", title = "null = 99%") +
theme(legend.title = element_blank())
legend_power <- get_legend(p_99_par + theme(legend.direction="horizontal",
legend.position="bottom"))
p_99_par <- ggplot(dat_99_par, aes(x = effectSize, y = value,group = variable,
col=variable)) +
geom_line(aes(linetype = variable), size = 1.5) +
labs(x = "ey", y = "power", title = "null = 99%") +
theme(legend.title = element_blank())
dat_99_par <- melt(dat_99[1:6,], id.var = "effectSize")
p_99_par <- ggplot(dat_99_par, aes(x = effectSize, y = log(value),group = variable,
col=variable)) +
geom_line(aes(linetype = variable), size = 1.5) +
labs(x = "ey", y = "log(power)", title = "null = 99%") +
theme(legend.position="none")
p_99_par <- ggplot(dat_99_par, aes(x = effectSize, y = value,group = variable,
col=variable)) +
geom_line(aes(linetype = variable), size = 1.5) +
labs(x = "ey", y = "power", title = "null = 99%") +
theme(legend.title = element_blank())
legend_power <- get_legend(p_99_par + theme(legend.direction="horizontal",
legend.position="bottom"))
p = plot_grid(p_.5, p_.9, p_.99, p_.5_low_ef, p_.9_low_ef, p_.99_low_ef,
ncol = 3, labels = letters[1:3])
title <- ggdraw() + draw_label("Power: et = ey")
plot_grid(title, p, legend_power, ncol = 1, rel_heights=c(.1, 1, .1))
dat_99 <- data.frame(filterEffectVec, t(FwerPowerFdrPower5e1[13:16,]))
colnames(dat_99) <- c("effectSize", "PRO", "BH", "RDW", "IHW")
dat_99_par <- melt(dat_99[1:6,], id.var = "effectSize")
p_99_par <- ggplot(dat_99_par, aes(x = effectSize, y = value,group = variable,
col=variable)) +
geom_line(aes(linetype = variable), size = 1.5) +
labs(x = "ey", y = "power", title = "null = 99%") +
theme(legend.title = element_blank())
legend_power <- get_legend(p_99_par + theme(legend.direction="horizontal",
legend.position="bottom"))
rm(list=ls())
setwd("U:/Documents/My Research (UGA)/Multiple Hypoetheses/Article-1")
library(ggplot2)
library(grid)
library(gridExtra)      # for multiplots in the same page
library(xtable)
library(reshape2)       # library for the melt function
library(cowplot)        # plot_grid function
load("U:/Documents/My Research (UGA)/Multiple Hypoetheses/Article-1/simu_fwerPowerFdrPower_cont.RDATA")
dat_99 <- data.frame(filterEffectVec, t(FwerPowerFdrPower5e1[13:16,]))
colnames(dat_99) <- c("effectSize", "PRO", "BH", "RDW", "IHW")
dat_99_par <- melt(dat_99[1:6,], id.var = "effectSize")
p_99_par <- ggplot(dat_99_par, aes(x = effectSize, y = value,group = variable,
col=variable)) +
geom_line(aes(linetype = variable), size = 1.5) +
labs(x = "ey", y = "power", title = "null = 99%") +
theme(legend.title = element_blank())
legend_power <- get_legend(p_99_par + theme(legend.direction="horizontal",
legend.position="bottom"))
nice_plots <- function(filterEffectVec, FwerPowerFdrPower, fdr = TRUE, null,
low_eff_plot = FALSE)
{
power_row_indx <- if(fdr == TRUE){13:16} else {5:8}
dat <- data.frame(filterEffectVec, t(FwerPowerFdrPower[power_row_indx, ]))
colnames(dat) <- c("effectSize", "PRO", "BH", "RDW", "IHW")
if(low_eff_plot == FALSE){
ylab = "Power"
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = value, group = variable,
col = variable))
} else {
ylab = "log(power)"
dat <- dat[1:6,]
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = log(value), group = variable,
col = variable))
}
plt = plt + geom_line(aes(linetype = variable), size = 1.5) +
labs(x = "Mean filter effect (ey)", y = ylab,
title = paste0("null = ", null, "%")) +
theme(legend.position = "none")
return(plt)
}
p_.5 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e1,
fdr = TRUE, null = 50, low_eff_plot = FALSE)
ey_vec <- c(seq(0, 1, .2), 2, 3, 5, 8)
p_.5 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e1,
fdr = TRUE, null = 50, low_eff_plot = FALSE)
p_.9 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower4e1,
fdr = TRUE, null = 50, low_eff_plot = FALSE)
p_.99 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower5e1,
fdr = TRUE, null = 50, low_eff_plot = FALSE)
p_.5_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e1,
fdr = TRUE, null = 50, low_eff_plot = TRUE)
p_.9_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower4e1,
fdr = TRUE, null = 50, low_eff_plot = TRUE)
p_.99_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower5e1,
fdr = TRUE, null = 50, low_eff_plot = TRUE)
p = plot_grid(p_.5, p_.9, p_.99, p_.5_low_ef, p_.9_low_ef, p_.99_low_ef,
ncol = 3, labels = letters[1:3])
title <- ggdraw() + draw_label("Power: et = ey")
plot_grid(title, p, legend_power, ncol = 1, rel_heights=c(.1, 1, .1))
nice_plots <- function(filterEffectVec, FwerPowerFdrPower, fdr = TRUE, null,
low_eff_plot = FALSE)
{
power_row_indx <- if(fdr == TRUE){13:16} else {5:8}
dat <- data.frame(filterEffectVec, t(FwerPowerFdrPower[power_row_indx, ]))
colnames(dat) <- c("effectSize", "PRO", "BH", "RDW", "IHW")
if(low_eff_plot == FALSE){
ylab = "Power"
nullProp = null
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = value, group = variable,
col = variable))
} else {
ylab = "log(power)"
nullProp = NULL
dat <- dat[1:6,]
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = log(value), group = variable,
col = variable))
}
plt = plt + geom_line(aes(linetype = variable), size = 1.5) +
labs(x = "Mean filter effect (ey)", y = ylab,
title = paste0("null = ", null, "%")) +
theme(legend.position = "none")
return(plt)
}
# plots of power for mean filter effect(ey) = mean test effect(et) (i.e cv =0)
#-------------------------------------------------------------------------------
ey_vec <- c(seq(0, 1, .2), 2, 3, 5, 8)
p_.5 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e1,
fdr = TRUE, null = 50, low_eff_plot = FALSE)
p_.9 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower4e1,
fdr = TRUE, null = 90, low_eff_plot = FALSE)
p_.99 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower5e1,
fdr = TRUE, null = 99, low_eff_plot = FALSE)
p_.5_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e1,
fdr = TRUE, null = 50, low_eff_plot = TRUE)
p_.9_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower4e1,
fdr = TRUE, null = 90, low_eff_plot = TRUE)
p_.99_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower5e1,
fdr = TRUE, null = 99, low_eff_plot = TRUE)
p = plot_grid(p_.5, p_.9, p_.99, p_.5_low_ef, p_.9_low_ef, p_.99_low_ef,
ncol = 3, labels = letters[1:3])
title <- ggdraw() + draw_label("Power: et = ey")
plot_grid(title, p, legend_power, ncol = 1, rel_heights=c(.1, 1, .1))
p = plot_grid(p_.5, p_.9, p_.99, p_.5_low_ef, p_.9_low_ef, p_.99_low_ef,
ncol = 3, labels = letters[1:3])
title <- ggdraw() + draw_label("Power: et = ey")
plot_grid(title, p, legend_power, ncol = 1, rel_heights=c(.1, 1, .1))
plot_grid(title, p, legend_power, ncol = 1, rel_heights=c(.1, 1, .1))
nice_plots <- function(filterEffectVec, FwerPowerFdrPower, fdr = TRUE, null,
low_eff_plot = FALSE)
{
power_row_indx <- if(fdr == TRUE){13:16} else {5:8}
dat <- data.frame(filterEffectVec, t(FwerPowerFdrPower[power_row_indx, ]))
colnames(dat) <- c("effectSize", "PRO", "BH", "RDW", "IHW")
if(low_eff_plot == FALSE){
ylab = "Power"
nullProp = null
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = value, group = variable,
col = variable))
} else {
ylab = "log(power)"
nullProp = NULL
dat <- dat[1:6,]
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = log(value), group = variable,
col = variable))
}
plt = plt + geom_line(aes(linetype = variable), size = 1.5) +
labs(x = "Mean filter effect (ey)", y = ylab,
title = paste0("null = ", nullProp, "%")) +
theme(legend.position = "none")
return(plt)
}
p_.5 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e1,
fdr = TRUE, null = 50, low_eff_plot = FALSE)
p_.9 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower4e1,
fdr = TRUE, null = 90, low_eff_plot = FALSE)
p_.99 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower5e1,
fdr = TRUE, null = 99, low_eff_plot = FALSE)
p_.5_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e1,
fdr = TRUE, null = 50, low_eff_plot = TRUE)
p_.9_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower4e1,
fdr = TRUE, null = 90, low_eff_plot = TRUE)
p_.99_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower5e1,
fdr = TRUE, null = 99, low_eff_plot = TRUE)
p = plot_grid(p_.5, p_.9, p_.99, p_.5_low_ef, p_.9_low_ef, p_.99_low_ef,
ncol = 3, labels = letters[1:3])
title <- ggdraw() + draw_label("Power: et = ey")
plot_grid(title, p, legend_power, ncol = 1, rel_heights=c(.1, 1, .1))
nice_plots <- function(filterEffectVec, FwerPowerFdrPower, fdr = TRUE, null,
low_eff_plot = FALSE)
{
power_row_indx <- if(fdr == TRUE){13:16} else {5:8}
dat <- data.frame(filterEffectVec, t(FwerPowerFdrPower[power_row_indx, ]))
colnames(dat) <- c("effectSize", "PRO", "BH", "RDW", "IHW")
if(low_eff_plot == FALSE){
ylab = "Power"
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = value, group = variable,
col = variable))
} else {
ylab = "log(power)"
dat <- dat[1:6,]
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = log(value), group = variable,
col = variable))
}
titl <- paste0("null = ", nullProp, "%")
plt = plt + geom_line(aes(linetype = variable), size = 1.5) +
labs(x = "Mean filter effect (ey)", y = ylab,
title = ifelse(low_eff_plot == FALSE, titl, NULL)) +
theme(legend.position = "none")
return(plt)
}
nice_plots <- function(filterEffectVec, FwerPowerFdrPower, fdr = TRUE, null,
low_eff_plot = FALSE)
{
power_row_indx <- if(fdr == TRUE){13:16} else {5:8}
dat <- data.frame(filterEffectVec, t(FwerPowerFdrPower[power_row_indx, ]))
colnames(dat) <- c("effectSize", "PRO", "BH", "RDW", "IHW")
if(low_eff_plot == FALSE){
ylab = "Power"
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = value, group = variable,
col = variable))
} else {
ylab = "log(power)"
dat <- dat[1:6,]
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = log(value), group = variable,
col = variable))
}
titl <- paste0("null = ", nullProp, "%")
plt = plt + geom_line(aes(linetype = variable), size = 1.5) +
labs(x = "Mean filter effect (ey)", y = ylab,
title = ifelse(low_eff_plot == FALSE, titl, NULL)) +
theme(legend.position = "none")
return(plt)
}
p_.5 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e1,
fdr = TRUE, null = 50, low_eff_plot = FALSE)
nice_plots <- function(filterEffectVec, FwerPowerFdrPower, fdr = TRUE, null,
low_eff_plot = FALSE)
{
power_row_indx <- if(fdr == TRUE){13:16} else {5:8}
dat <- data.frame(filterEffectVec, t(FwerPowerFdrPower[power_row_indx, ]))
colnames(dat) <- c("effectSize", "PRO", "BH", "RDW", "IHW")
if(low_eff_plot == FALSE){
ylab = "Power"
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = value, group = variable,
col = variable))
} else {
ylab = "log(power)"
dat <- dat[1:6,]
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = log(value), group = variable,
col = variable))
}
titl <- paste0("null = ", null, "%")
plt = plt + geom_line(aes(linetype = variable), size = 1.5) +
labs(x = "Mean filter effect (ey)", y = ylab,
title = ifelse(low_eff_plot == FALSE, titl, NULL)) +
theme(legend.position = "none")
return(plt)
}
p_.5 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e1,
fdr = TRUE, null = 50, low_eff_plot = FALSE)
p_.9 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower4e1,
fdr = TRUE, null = 90, low_eff_plot = FALSE)
p_.99 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower5e1,
fdr = TRUE, null = 99, low_eff_plot = FALSE)
p_.5_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e1,
fdr = TRUE, null = 50, low_eff_plot = TRUE)
nice_plots <- function(filterEffectVec, FwerPowerFdrPower, fdr = TRUE, null,
low_eff_plot = FALSE)
{
power_row_indx <- if(fdr == TRUE){13:16} else {5:8}
dat <- data.frame(filterEffectVec, t(FwerPowerFdrPower[power_row_indx, ]))
colnames(dat) <- c("effectSize", "PRO", "BH", "RDW", "IHW")
if(low_eff_plot == FALSE){
ylab = "Power"
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = value, group = variable,
col = variable))
} else {
ylab = "log(power)"
dat <- dat[1:6,]
dat_melt <- melt(dat, id.var = "effectSize")
plt <- ggplot(dat_melt, aes(x = effectSize, y = log(value), group = variable,
col = variable))
}
titl <- paste0("null = ", null, "%")
plt = plt + geom_line(aes(linetype = variable), size = 1.5) +
labs(x = "Mean filter effect (ey)", y = ylab,
title = if(low_eff_plot == FALSE){titl}) +
theme(legend.position = "none")
return(plt)
}
p_.5 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e1,
fdr = TRUE, null = 50, low_eff_plot = FALSE)
p_.9 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower4e1,
fdr = TRUE, null = 90, low_eff_plot = FALSE)
p_.99 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower5e1,
fdr = TRUE, null = 99, low_eff_plot = FALSE)
p_.5_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e1,
fdr = TRUE, null = 50, low_eff_plot = TRUE)
p_.9_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower4e1,
fdr = TRUE, null = 90, low_eff_plot = TRUE)
p_.99_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower5e1,
fdr = TRUE, null = 99, low_eff_plot = TRUE)
p = plot_grid(p_.5, p_.9, p_.99, p_.5_low_ef, p_.9_low_ef, p_.99_low_ef,
ncol = 3, labels = letters[1:3])
title <- ggdraw() + draw_label("Power: et = ey")
plot_grid(title, p, legend_power, ncol = 1, rel_heights=c(.1, 1, .1))
ey_vec <- c(seq(0, 1, .2), 2, 3, 5, 8)
p_.5 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e2,
fdr = TRUE, null = 50, low_eff_plot = FALSE)
p_.9 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower4e2,
fdr = TRUE, null = 90, low_eff_plot = FALSE)
p_.99 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower5e2,
fdr = TRUE, null = 99, low_eff_plot = FALSE)
p_.5_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e2,
fdr = TRUE, null = 50, low_eff_plot = TRUE)
p_.9_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower4e2,
fdr = TRUE, null = 90, low_eff_plot = TRUE)
p_.99_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower5e2,
fdr = TRUE, null = 99, low_eff_plot = TRUE)
p = plot_grid(p_.5, p_.9, p_.99, p_.5_low_ef, p_.9_low_ef, p_.99_low_ef,
ncol = 3, labels = letters[1:3])
title <- ggdraw() + draw_label("Power: et ~ Normal(ey, ey/2)")
plot_grid(title, p, legend_power, ncol = 1, rel_heights=c(.1, 1, .1))
p_.5 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e2,
fdr = TRUE, null = 50, low_eff_plot = FALSE)
p_.5 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e2,
fdr = TRUE, null = 50, low_eff_plot = FALSE)
p_.9 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower4e2,
fdr = TRUE, null = 90, low_eff_plot = FALSE)
p_.99 <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower5e2,
fdr = TRUE, null = 99, low_eff_plot = FALSE)
p_.5_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower2e2,
fdr = TRUE, null = 50, low_eff_plot = TRUE)
p_.9_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower4e2,
fdr = TRUE, null = 90, low_eff_plot = TRUE)
p_.99_low_ef <- nice_plots(filterEffectVec = ey_vec, FwerPowerFdrPower = FwerPowerFdrPower5e2,
fdr = TRUE, null = 99, low_eff_plot = TRUE)
p = plot_grid(p_.5, p_.9, p_.99, p_.5_low_ef, p_.9_low_ef, p_.99_low_ef,
ncol = 3, labels = letters[1:3])
title <- ggdraw() + draw_label("Power: et ~ Normal(ey, ey/2)")
plot_grid(title, p, legend_power, ncol = 1, rel_heights=c(.1, 1, .1))
p = plot_grid(p_.5, p_.9, p_.99, p_.5_low_ef, p_.9_low_ef, p_.99_low_ef,
ncol = 3, labels = letters[1:3])
title <- ggdraw() + draw_label("Power: et ~ Normal(ey, ey/2)")
plot_grid(title, p, legend_power, ncol = 1, rel_heights=c(.1, 1, .1))
