prob_weight_plots(ey_index = c(7, 17, 27, 37), null_index = c(26, 27, 28),
m = 10000, ey = 2, null = 50, prob = ranksProb, weight = ranksWeight)
prob_weight_plots <- function(ey_index, null_index, m, ey, null, prob, weight)
{
ranks = 1:m
prob_by_null = data.frame(ranks, prob[ , ey_index])
names(prob_by_null) <- c("ranks", "20%", "50%", "75%", "90%")
prob_by_null_melt <- melt(prob_by_null, id.var = "ranks",
variable.name = "null prop.")
prob_plot = ggplot(prob_by_null_melt, aes(x = ranks,
y = value, group = `null prop.`,
colour = `null prop.`)) +
geom_line(aes(linetype = `null prop.`), size = 1.5) +
labs(x = "Ranks", y = "p(rank | effect)", title = paste0("et = ey = ", ey))+
theme(legend.position="none")
prob_by_effect <- data.frame(ranks, prob[ , null_index])
colnames(prob_by_effect) <- c("ranks", "0.6", "2.0", "5.0")
prob_by_effect_melt <- melt(prob_by_effect, id.var = "ranks",
variable.name = "effect size")
prob_plot_by_effect = ggplot(prob_by_effect_melt, aes(x = prob_by_effect_melt$ranks,
y = prob_by_effect_melt$value, group = prob_by_effect_melt$`effect size`,
colour = prob_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = prob_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "p(rank | effect)", title = paste0("null = ", null, "%"))+
theme(legend.position="none")
weight_by_null = data.frame(ranks, weight[ , ey_index])
names(weight_by_null) <- c("ranks", "20%", "50%", "75%", "90%")
weight_by_null_melt <- melt(weight_by_null, id.var = "ranks",
variable.name = "null prop.")
weight_plot = ggplot(weight_by_null_melt, aes(x = weight_by_null_melt$ranks,
y = log(weight_by_null_melt$value), group = weight_by_null_melt$`null prop.`,
colour = weight_by_null_melt$`null prop.`)) +
geom_line(aes(linetype = weight_by_null_melt$`null prop.`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)")+
theme(legend.direction = "horizontal", legend.position = "bottom")
weight_by_effect <- data.frame(ranks, weight[ , null_index])
colnames(weight_by_effect) <- c("ranks", "0.6", "2.0", "5.0")
weight_by_effect_melt <- melt(weight_by_effect, id.var = "ranks",
variable.name = "effect size")
weight_plot_by_effect = ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
group = weight_by_effect_melt$`effect size`,
colour = weight_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)")+
theme(legend.direction = "horizontal", legend.position = "bottom")
pp <- plot_grid(prob_plot, prob_plot_by_effect, weight_plot, weight_plot_by_effect,
nrow = 2, labels = c("a", "b"), align = 'hv')
title <- ggdraw() + draw_label("Continuous: probability and weight vs. rank")
plots = plot_grid(title, pp, ncol = 1, rel_heights=c(.1, 1))
return(plots)
}
prob_weight_plots(ey_index = c(7, 17, 27, 37), null_index = c(26, 27, 28),
m = 10000, ey = 2, null = 50, prob = ranksProb, weight = ranksWeight)
prob_weight_plots <- function(ey_index, null_index, m, ey, null, prob, weight)
{
ranks = 1:m
prob_by_null = data.frame(ranks, prob[ , ey_index])
names(prob_by_null) <- c("ranks", "20%", "50%", "75%", "90%")
prob_by_null_melt <- melt(prob_by_null, id.var = "ranks",
variable.name = "null prop.")
prob_plot = ggplot(prob_by_null_melt, aes(x = ranks,
y = value, group = `null prop.`,
colour = `null prop.`)) +
geom_line(aes(linetype = `null prop.`), size = 1.5) +
labs(x = "Ranks", y = "p(rank | effect)", title = paste0("et = ey = ", ey))+
theme(legend.position="none")
prob_by_effect <- data.frame(ranks, prob[ , null_index])
colnames(prob_by_effect) <- c("ranks", "0.6", "2.0", "5.0")
prob_by_effect_melt <- melt(prob_by_effect, id.var = "ranks",
variable.name = "effect size")
prob_plot_by_effect = ggplot(prob_by_effect_melt, aes(x = prob_by_effect_melt$ranks,
y = prob_by_effect_melt$value, group = prob_by_effect_melt$`effect size`,
colour = prob_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = prob_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "p(rank | effect)", title = paste0("null = ", null, "%"))+
theme(legend.position="none")
weight_by_null = data.frame(ranks, weight[ , ey_index])
names(weight_by_null) <- c("ranks", "20%", "50%", "75%", "90%")
weight_by_null_melt <- melt(weight_by_null, id.var = "ranks",
variable.name = "null prop.")
weight_plot = ggplot(weight_by_null_melt, aes(x = weight_by_null_melt$ranks,
y = log(weight_by_null_melt$value), group = weight_by_null_melt$`null prop.`,
colour = weight_by_null_melt$`null prop.`)) +
geom_line(aes(linetype = weight_by_null_melt$`null prop.`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)")+
theme(legend.direction = "horizontal", legend.position = "bottom")
weight_by_effect <- data.frame(ranks, weight[ , null_index])
colnames(weight_by_effect) <- c("ranks", "0.6", "2.0", "5.0")
weight_by_effect_melt <- melt(weight_by_effect, id.var = "ranks",
variable.name = "effect size")
weight_plot_by_effect = ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
group = weight_by_effect_melt$`effect size`,
colour = weight_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)")+
theme(legend.direction = "horizontal", legend.position = "bottom")
pp <- plot_grid(prob_plot, prob_plot_by_effect, weight_plot, weight_plot_by_effect,
nrow = 2, labels = c("a", "b"), align = 'v')
title <- ggdraw() + draw_label("Continuous: probability and weight vs. rank")
plots = plot_grid(title, pp, ncol = 1, rel_heights=c(.1, 1))
return(plots)
}
prob_weight_plots(ey_index = c(7, 17, 27, 37), null_index = c(26, 27, 28),
m = 10000, ey = 2, null = 50, prob = ranksProb, weight = ranksWeight)
prob_weight_plots <- function(ey_index, null_index, m, ey, null, prob, weight)
{
ranks = 1:m
prob_by_null = data.frame(ranks, prob[ , ey_index])
names(prob_by_null) <- c("ranks", "20%", "50%", "75%", "90%")
prob_by_null_melt <- melt(prob_by_null, id.var = "ranks",
variable.name = "null prop.")
prob_plot = ggplot(prob_by_null_melt, aes(x = prob_by_null_melt$ranks,
y = prob_by_null_melt$value, group = prob_by_null_melt$`null prop.`,
colour = prob_by_null_melt$`null prop.`)) +
geom_line(aes(linetype = prob_by_null_melt$`null prop.`), size = 1.5) +
labs(x = "Ranks", y = "p(rank | effect)", title = paste0("et = ey = ", ey))+
theme(legend.position="none")
prob_by_effect <- data.frame(ranks, prob[ , null_index])
colnames(prob_by_effect) <- c("ranks", "0.6", "2.0", "5.0")
prob_by_effect_melt <- melt(prob_by_effect, id.var = "ranks",
variable.name = "effect size")
prob_plot_by_effect = ggplot(prob_by_effect_melt, aes(x = prob_by_effect_melt$ranks,
y = prob_by_effect_melt$value, group = prob_by_effect_melt$`effect size`,
colour = prob_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = prob_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "p(rank | effect)", title = paste0("null = ", null, "%"))+
theme(legend.position="none")
weight_by_null = data.frame(ranks, weight[ , ey_index])
names(weight_by_null) <- c("ranks", "20%", "50%", "75%", "90%")
weight_by_null_melt <- melt(weight_by_null, id.var = "ranks",
variable.name = "null prop.")
weight_plot = ggplot(weight_by_null_melt, aes(x = weight_by_null_melt$ranks,
y = log(weight_by_null_melt$value), group = weight_by_null_melt$`null prop.`,
colour = weight_by_null_melt$`null prop.`)) +
geom_line(aes(linetype = weight_by_null_melt$`null prop.`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)")+
theme(legend.direction = "horizontal", legend.position = "bottom")
weight_by_effect <- data.frame(ranks, weight[ , null_index])
colnames(weight_by_effect) <- c("ranks", "0.6", "2.0", "5.0")
weight_by_effect_melt <- melt(weight_by_effect, id.var = "ranks",
variable.name = "effect size")
weight_plot_by_effect = ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
group = weight_by_effect_melt$`effect size`,
colour = weight_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)")+
theme(legend.direction = "horizontal", legend.position = "bottom")
pp <- plot_grid(prob_plot, prob_plot_by_effect, weight_plot, weight_plot_by_effect,
nrow = 2, labels = c("a", "b"), align = 'v')
title <- ggdraw() + draw_label("Continuous: probability and weight vs. rank")
plots = plot_grid(title, pp, ncol = 1, rel_heights=c(.1, 1))
return(plots)
}
prob_weight_plots(ey_index = c(7, 17, 27, 37), null_index = c(26, 27, 28),
m = 10000, ey = 2, null = 50, prob = ranksProb, weight = ranksWeight)
prob_weight_plots <- function(ey_index, null_index, m, ey, null, prob, weight)
{
ranks = 1:m
prob_by_null = data.frame(ranks, prob[ , ey_index])
names(prob_by_null) <- c("ranks", "20%", "50%", "75%", "90%")
prob_by_null_melt <- melt(prob_by_null, id.var = "ranks",
variable.name = "null prop.")
prob_plot = ggplot(prob_by_null_melt, aes(x = prob_by_null_melt$ranks,
y = prob_by_null_melt$value, group = prob_by_null_melt$`null prop.`,
colour = prob_by_null_melt$`null prop.`)) +
geom_line(aes(linetype = prob_by_null_melt$`null prop.`), size = 1.5) +
labs(x = "Ranks", y = "p(rank | effect)", title = paste0("et = ey = ", ey))+
theme(legend.position="none")
prob_by_effect <- data.frame(ranks, prob[ , null_index])
colnames(prob_by_effect) <- c("ranks", "0.6", "2.0", "5.0")
prob_by_effect_melt <- melt(prob_by_effect, id.var = "ranks",
variable.name = "effect size")
prob_plot_by_effect = ggplot(prob_by_effect_melt, aes(x = prob_by_effect_melt$ranks,
y = prob_by_effect_melt$value, group = prob_by_effect_melt$`effect size`,
colour = prob_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = prob_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "p(rank | effect)", title = paste0("null = ", null, "%"))+
theme(legend.position="none")
weight_by_null = data.frame(ranks, weight[ , ey_index])
names(weight_by_null) <- c("ranks", "20%", "50%", "75%", "90%")
weight_by_null_melt <- melt(weight_by_null, id.var = "ranks",
variable.name = "null prop.")
attach(weight_by_null_melt)
weight_plot = ggplot(weight_by_null_melt, aes(x = ranks,
y = log(value), group = `null prop.`,
colour = `null prop.`)) +
geom_line(aes(linetype = `null prop.`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)")+
theme(legend.direction = "horizontal", legend.position = "bottom")
detach(weight_by_null_melt)
weight_by_effect <- data.frame(ranks, weight[ , null_index])
colnames(weight_by_effect) <- c("ranks", "0.6", "2.0", "5.0")
weight_by_effect_melt <- melt(weight_by_effect, id.var = "ranks",
variable.name = "effect size")
attach(weight_by_effect_melt)
weight_plot_by_effect = ggplot(weight_by_effect_melt, aes(x = ranks,
y = log(value),
group = `effect size`,
colour = `effect size`)) +
geom_line(aes(linetype = `effect size`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)")+
theme(legend.direction = "horizontal", legend.position = "bottom")
detach(weight_by_effect_melt)
pp <- plot_grid(prob_plot, prob_plot_by_effect, weight_plot, weight_plot_by_effect,
nrow = 2, labels = c("a", "b"), align = 'v')
title <- ggdraw() + draw_label("Continuous: probability and weight vs. rank")
plots = plot_grid(title, pp, ncol = 1, rel_heights=c(.1, 1))
return(plots)
}
prob_weight_plots(ey_index = c(7, 17, 27, 37), null_index = c(26, 27, 28),
m = 10000, ey = 2, null = 50, prob = ranksProb, weight = ranksWeight)
library(OPWpaper)
prob_weight_plots <- function(ey_index, null_index, m, ey, null, prob, weight)
{
ranks = 1:m
prob_by_null = data.frame(ranks, prob[ , ey_index])
names(prob_by_null) <- c("ranks", "20%", "50%", "75%", "90%")
prob_by_null_melt <- melt(prob_by_null, id.var = "ranks",
variable.name = "null prop.")
prob_plot = ggplot(prob_by_null_melt, aes(x = prob_by_null_melt$ranks,
y = prob_by_null_melt$value, group = prob_by_null_melt$`null prop.`,
colour = prob_by_null_melt$`null prop.`)) +
geom_line(aes(linetype = prob_by_null_melt$`null prop.`), size = 1.5) +
labs(x = "Ranks", y = "p(rank | effect)", title = paste0("et = ey = ", ey))+
theme(legend.position="none")
prob_by_effect <- data.frame(ranks, prob[ , null_index])
colnames(prob_by_effect) <- c("ranks", "0.6", "2.0", "5.0")
prob_by_effect_melt <- melt(prob_by_effect, id.var = "ranks",
variable.name = "effect size")
prob_plot_by_effect = ggplot(prob_by_effect_melt, aes(x = prob_by_effect_melt$ranks,
y = prob_by_effect_melt$value, group = prob_by_effect_melt$`effect size`,
colour = prob_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = prob_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "p(rank | effect)", title = paste0("null = ", null, "%"))+
theme(legend.position="none")
weight_by_null = data.frame(ranks, weight[ , ey_index])
names(weight_by_null) <- c("ranks", "20%", "50%", "75%", "90%")
weight_by_null_melt <- melt(weight_by_null, id.var = "ranks",
variable.name = "null prop.")
weight_plot = ggplot(weight_by_null_melt, aes(x = weight_by_null_melt$ranks,
y = log(weight_by_null_melt$value), group = weight_by_null_melt$`null prop.`,
colour = weight_by_null_melt$`null prop.`)) +
geom_line(aes(linetype = weight_by_null_melt$`null prop.`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)")+
theme(legend.direction = "horizontal", legend.position = "bottom")
weight_by_effect <- data.frame(ranks, weight[ , null_index])
colnames(weight_by_effect) <- c("ranks", "0.6", "2.0", "5.0")
weight_by_effect_melt <- melt(weight_by_effect, id.var = "ranks",
variable.name = "effect size")
weight_plot_by_effect = ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
group = weight_by_effect_melt$`effect size`,
colour = weight_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)")+
theme(legend.direction = "horizontal", legend.position = "bottom")
pp <- plot_grid(prob_plot, prob_plot_by_effect, weight_plot, weight_plot_by_effect,
nrow = 2, labels = c("a", "b"), align = 'v')
title <- ggdraw() + draw_label("Continuous: probability and weight vs. rank")
plots = plot_grid(title, pp, ncol = 1, rel_heights=c(.1, 1))
return(plots)
}
prob_weight_plots(ey_index = c(7, 17, 27, 37), null_index = c(26, 27, 28),
m = 10000, ey = 2, null = 50, prob = ranksProb, weight = ranksWeight)
ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value))) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)")+
theme(legend.direction = "horizontal", legend.position = "bottom")
weight_plot_by_effect = weight_plot_by_effect + scale_color_discrete(name="null prop.")
weight_plot_by_effect = ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value))) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)")+
theme(legend.direction = "horizontal", legend.position = "bottom")
weight_plot_by_effect = weight_plot_by_effect + scale_color_discrete(name="null prop.")
weight_plot_by_effect
weight_plot_by_effect = ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value))) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)")+
theme(legend.direction = "horizontal", legend.position = "bottom")
weight_plot_by_effect = weight_plot_by_effect + scale_color_discrete()
weight_plot_by_effect
weight_plot_by_effect = ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value))) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)")+
theme(legend.direction = "horizontal", legend.position = "bottom")
weight_plot_by_effect + scale_color_discrete(color="null prop")
ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value))) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)", colour = "null prop")+
theme(legend.direction = "horizontal", legend.position = "bottom")
ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
group = weight_by_effect_melt$`effect size`,
colour = weight_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)")+
theme(legend.direction = "horizontal", legend.position = "bottom")
ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
group = weight_by_effect_melt$`effect size`,
colour = weight_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)", color = "null prop.")+
theme(legend.direction = "horizontal", legend.position = "bottom")
ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
colour = weight_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)", color = "null prop.")+
theme(legend.direction = "horizontal", legend.position = "bottom")
ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
group = weight_by_effect_melt$`effect size`,
)) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)", color = "null prop.")+
theme(legend.direction = "horizontal", legend.position = "bottom")
ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
group = weight_by_effect_melt$`effect size`,
colour = weight_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)", color = "null prop.")+
theme(legend.direction = "horizontal", legend.position = "none")
ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
group = weight_by_effect_melt$`effect size`,
colour = weight_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
scale_colour_gradient() +
labs(x = "Ranks", y = "log(weight)", color = "null prop.")+
theme(legend.direction = "horizontal", legend.position = "bottom")
ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
group = weight_by_effect_melt$`effect size`,
colour = weight_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
scale_colour_brewer() +
labs(x = "Ranks", y = "log(weight)", color = "null prop.")+
theme(legend.direction = "horizontal", legend.position = "bottom")
ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
group = weight_by_effect_melt$`effect size`,
colour = weight_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
scale_colour_distiller() +
labs(x = "Ranks", y = "log(weight)", color = "null prop.")+
theme(legend.direction = "horizontal", legend.position = "bottom")
ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
group = weight_by_effect_melt$`effect size`,
colour = weight_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
scale_colour_discrete() +
labs(x = "Ranks", y = "log(weight)", color = "null prop.")+
theme(legend.direction = "horizontal", legend.position = "bottom")
?theme
ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
group = weight_by_effect_melt$`effect size`,
colour = weight_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)", color = "null prop.")+
theme(legend.direction = "horizontal", legend.position = "bottom", legend.title = "null prop.")
ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
group = weight_by_effect_melt$`effect size`,
colour = weight_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)", color = "null prop.")+
theme(legend.direction = "horizontal", legend.position = "bottom", legend.title = element_text("null prop."))
ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
group = weight_by_effect_melt$`effect size`,
colour = weight_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)", color = "null prop.")+
theme(legend.direction = "horizontal", legend.position = "bottom", legend.title = element_text())
ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
group = weight_by_effect_melt$`effect size`,
colour = weight_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)", color = "null prop.")+
theme(legend.direction = "horizontal", legend.position = "bottom", legend.title = element_blank())
ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
group = weight_by_effect_melt$`effect size`,
colour = weight_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = weight_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "log(weight)", color = "null prop.")+
theme(legend.direction = "horizontal", legend.position = "bottom")
ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
group = weight_by_effect_melt$`effect size`,
colour = weight_by_effect_melt$`effect size`)) +
geom_line(size = 1.5) +
labs(x = "Ranks", y = "log(weight)", color = "null prop.")+
theme(legend.direction = "horizontal", legend.position = "bottom")
prob_weight_plots <- function(ey_index, null_index, m, ey, null, prob, weight)
{
ranks = 1:m
prob_by_null = data.frame(ranks, prob[ , ey_index])
names(prob_by_null) <- c("ranks", "20%", "50%", "75%", "90%")
prob_by_null_melt <- melt(prob_by_null, id.var = "ranks",
variable.name = "null prop.")
prob_plot = ggplot(prob_by_null_melt, aes(x = prob_by_null_melt$ranks,
y = prob_by_null_melt$value, group = prob_by_null_melt$`null prop.`,
colour = prob_by_null_melt$`null prop.`)) +
geom_line(aes(linetype = prob_by_null_melt$`null prop.`), size = 1.5) +
labs(x = "Ranks", y = "p(rank | effect)", title = paste0("et = ey = ", ey))+
theme(legend.position="none")
prob_by_effect <- data.frame(ranks, prob[ , null_index])
colnames(prob_by_effect) <- c("ranks", "0.6", "2.0", "5.0")
prob_by_effect_melt <- melt(prob_by_effect, id.var = "ranks",
variable.name = "effect size")
prob_plot_by_effect = ggplot(prob_by_effect_melt, aes(x = prob_by_effect_melt$ranks,
y = prob_by_effect_melt$value, group = prob_by_effect_melt$`effect size`,
colour = prob_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = prob_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "p(rank | effect)", title = paste0("null = ", null, "%"))+
theme(legend.position="none")
weight_by_null = data.frame(ranks, weight[ , ey_index])
names(weight_by_null) <- c("ranks", "20%", "50%", "75%", "90%")
weight_by_null_melt <- melt(weight_by_null, id.var = "ranks",
variable.name = "null prop.")
weight_plot = ggplot(weight_by_null_melt, aes(x = weight_by_null_melt$ranks,
y = log(weight_by_null_melt$value), group = weight_by_null_melt$`null prop.`,
colour = weight_by_null_melt$`null prop.`)) +
geom_line(size = 1.5) +
labs(x = "Ranks", y = "log(weight)")+
theme(legend.direction = "horizontal", legend.position = "bottom")
weight_by_effect <- data.frame(ranks, weight[ , null_index])
colnames(weight_by_effect) <- c("ranks", "0.6", "2.0", "5.0")
weight_by_effect_melt <- melt(weight_by_effect, id.var = "ranks",
variable.name = "effect size")
weight_plot_by_effect = ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
group = weight_by_effect_melt$`effect size`,
colour = weight_by_effect_melt$`effect size`)) +
geom_line(size = 1.5) +
labs(x = "Ranks", y = "log(weight)", color = "effect size")+
theme(legend.direction = "horizontal", legend.position = "bottom")
pp <- plot_grid(prob_plot, prob_plot_by_effect, weight_plot, weight_plot_by_effect,
nrow = 2, labels = c("a", "b"), align = 'v')
title <- ggdraw() + draw_label("Continuous: probability and weight vs. rank")
plots = plot_grid(title, pp, ncol = 1, rel_heights=c(.1, 1))
return(plots)
}
prob_weight_plots(ey_index = c(7, 17, 27, 37), null_index = c(26, 27, 28),
m = 10000, ey = 2, null = 50, prob = ranksProb, weight = ranksWeight)
prob_weight_plots <- function(ey_index, null_index, m, ey, null, prob, weight)
{
ranks = 1:m
prob_by_null = data.frame(ranks, prob[ , ey_index])
names(prob_by_null) <- c("ranks", "20%", "50%", "75%", "90%")
prob_by_null_melt <- melt(prob_by_null, id.var = "ranks",
variable.name = "null prop.")
prob_plot = ggplot(prob_by_null_melt, aes(x = prob_by_null_melt$ranks,
y = prob_by_null_melt$value, group = prob_by_null_melt$`null prop.`,
colour = prob_by_null_melt$`null prop.`)) +
geom_line(aes(linetype = prob_by_null_melt$`null prop.`), size = 1.5) +
labs(x = "Ranks", y = "p(rank | effect)", title = paste0("et = ey = ", ey))+
theme(legend.position="none")
prob_by_effect <- data.frame(ranks, prob[ , null_index])
colnames(prob_by_effect) <- c("ranks", "0.6", "2.0", "5.0")
prob_by_effect_melt <- melt(prob_by_effect, id.var = "ranks",
variable.name = "effect size")
prob_plot_by_effect = ggplot(prob_by_effect_melt, aes(x = prob_by_effect_melt$ranks,
y = prob_by_effect_melt$value, group = prob_by_effect_melt$`effect size`,
colour = prob_by_effect_melt$`effect size`)) +
geom_line(aes(linetype = prob_by_effect_melt$`effect size`), size = 1.5) +
labs(x = "Ranks", y = "p(rank | effect)", title = paste0("null = ", null, "%"))+
theme(legend.position="none")
weight_by_null = data.frame(ranks, weight[ , ey_index])
names(weight_by_null) <- c("ranks", "20%", "50%", "75%", "90%")
weight_by_null_melt <- melt(weight_by_null, id.var = "ranks",
variable.name = "null prop.")
weight_plot = ggplot(weight_by_null_melt, aes(x = weight_by_null_melt$ranks,
y = log(weight_by_null_melt$value), group = weight_by_null_melt$`null prop.`,
colour = weight_by_null_melt$`null prop.`)) +
geom_line(size = 1.5) +
labs(x = "Ranks", y = "log(weight)", color = "null prop.")+
theme(legend.direction = "horizontal", legend.position = "bottom")
weight_by_effect <- data.frame(ranks, weight[ , null_index])
colnames(weight_by_effect) <- c("ranks", "0.6", "2.0", "5.0")
weight_by_effect_melt <- melt(weight_by_effect, id.var = "ranks",
variable.name = "effect size")
weight_plot_by_effect = ggplot(weight_by_effect_melt, aes(x = weight_by_effect_melt$ranks,
y = log(weight_by_effect_melt$value),
group = weight_by_effect_melt$`effect size`,
colour = weight_by_effect_melt$`effect size`)) +
geom_line(size = 1.5) +
labs(x = "Ranks", y = "log(weight)", color = "effect size")+
theme(legend.direction = "horizontal", legend.position = "bottom")
pp <- plot_grid(prob_plot, prob_plot_by_effect, weight_plot, weight_plot_by_effect,
nrow = 2, labels = c("a", "b"), align = 'v')
title <- ggdraw() + draw_label("Continuous: probability and weight vs. rank")
plots = plot_grid(title, pp, ncol = 1, rel_heights=c(.1, 1))
return(plots)
}
prob_weight_plots(ey_index = c(7, 17, 27, 37), null_index = c(26, 27, 28),
m = 10000, ey = 2, null = 50, prob = ranksProb, weight = ranksWeight)
library(OPWpaper)
